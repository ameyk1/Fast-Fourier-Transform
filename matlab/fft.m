% Engineer: Amey Kulkarni
% Module Name:  fft
% Project Name: Fast Fourier Transform (16-point)

clc;
clear;

N = 16;

W = zeros(0, N/2);

for n = 0:N/2-1
    W(n+1) = exp((-j * 2 * pi * n) / N);
    fprintf ('W[%d] = %.14f + %.14fj\n', n, real(W(n+1)), imag(W(n+1)));
end


a = zeros(0, N);
a1 = zeros(0, N);
a2 = zeros(0, N);
a3 = zeros(0, N);
a4 = zeros(0, N);
a(1) = 0;
a(2) = 8;
a(3) = 4;
a(4) = 12;
a(5) = 2;
a(6) = 10;
a(7) = 6;
a(8) = 14;
a(9) = 1;
a(10) = 9;
a(11) = 5;
a(12) = 13;
a(13) = 3;
a(14) = 11;
a(15) = 7;
a(16) = 15;
a

% Stage 1
for n=1:2:N
    a1(n) = a(n) + a(n+1)*W(1);
    a1(n+1) = a(n) - a(n+1)*W(1);
end
a1

% Stage 2
a2( 1) = a1( 1) + a1( 3)*W(1);
a2( 3) = a1( 1) - a1( 3)*W(1);
a2( 2) = a1( 2) + a1( 4)*W(5);
a2( 4) = a1( 2) - a1( 4)*W(5);
a2( 5) = a1( 5) + a1( 7)*W(1);
a2( 7) = a1( 5) - a1( 7)*W(1);
a2( 6) = a1( 6) + a1( 8)*W(5);
a2( 8) = a1( 6) - a1( 8)*W(5);
a2( 9) = a1( 9) + a1(11)*W(1);
a2(11) = a1( 9) - a1(11)*W(1);
a2(10) = a1(10) + a1(12)*W(5);
a2(12) = a1(10) - a1(12)*W(5);
a2(13) = a1(13) + a1(15)*W(1);
a2(15) = a1(13) - a1(15)*W(1);
a2(14) = a1(14) + a1(16)*W(5);
a2(16) = a1(14) - a1(16)*W(5);

a2

% Stage 3
a3( 1) = a2( 1) + a2( 5)*W(1);
a3( 5) = a2( 1) - a2( 5)*W(1);
a3( 2) = a2( 2) + a2( 6)*W(5);
a3( 6) = a2( 2) - a2( 6)*W(5);
a3( 3) = a2( 3) + a2( 7)*W(1);
a3( 7) = a2( 3) - a2( 7)*W(1);
a3( 4) = a2( 4) + a2( 8)*W(3);
a3( 8) = a2( 4) - a2( 8)*W(3);
a3( 9) = a2( 9) + a2(13)*W(1);
a3(13) = a2( 9) - a2(13)*W(1);
a3(10) = a2(10) + a2(14)*W(3);
a3(14) = a2(10) - a2(14)*W(3);
a3(11) = a2(11) + a2(15)*W(1);
a3(15) = a2(11) - a2(15)*W(1);
a3(12) = a2(12) + a2(16)*W(3);
a3(16) = a2(12) - a2(16)*W(3);
a3

% Stage 4
a4( 1) = a3( 1) + a3( 9)*W(1);
a4( 9) = a3( 1) - a3( 9)*W(1);
a4( 2) = a3( 2) + a3(10)*W(5);
a4(10) = a3( 2) - a3(10)*W(5);
a4( 3) = a3( 3) + a3(11)*W(1);
a4(11) = a3( 3) - a3(11)*W(1);
a4( 4) = a3( 4) + a3(12)*W(3);
a4(12) = a3( 4) - a3(12)*W(3);
a4( 5) = a3( 5) + a3(13)*W(1);
a4(13) = a3( 5) - a3(13)*W(1);
a4( 6) = a3( 6) + a3(14)*W(3);
a4(14) = a3( 6) - a3(14)*W(3);
a4( 7) = a3( 7) + a3(15)*W(1);
a4(15) = a3( 7) - a3(15)*W(1);
a4( 8) = a3( 8) + a3(16)*W(3);
a4(16) = a3( 8) - a3(16)*W(3);
a4
